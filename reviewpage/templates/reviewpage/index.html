{% extends 'base-review.html' %}

{% block content %}
	<h1>Review Page</h1>
  		{% if user.is_authenticated %}
    		<a  href="/reviews/new" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
      		<i  class="material-icons">add</i>
			</a>
		{% endif %}

		<select id="sort-select" onchange="location = this.value;">
    		<option class="sort-date" value="/">최신순</option>
    		<option class="sort-likes" value="?sort=likes">좋아요순</option>
			{% if user.is_authenticated %}
			<option class="sort-mypost" value="?sort=mypost">내 리뷰</option>
			{% endif %}
		</select>
		<br>
		
		{% for review in reviews %}
		<div class="review_bigrow">
			<div class="review_bigcolumn">
				<div class="product_image">
					{% if review.product.photo %}
						<a href="/products/{{ product.id }}"><img id ="product-image" src = {{ review.product.photo }}></a>
					{% endif %}
					<!--{% if review.product.PBstore%}
						<img src="{{ product.PBstore }}" width = "20" alt="">
					{% endif %}-->
				</div>
			</div>
			<div class="review_bigcolumn">
				<div class="review_box">
					<div class="rankings">
						<img src="{{ review.emoticon }}" width = "30"> {{ review.review_rating }}
					</div>
					{% if review.photo %}
					<div class="review_row">
						<div class="review_column">
							<div class="review_text">
								{{ review.content }}
								<!--{{ review.content|safe|truncatewords:"1"|linebreaks }}
								<a href="/reviews/{{ review.id }}">더보기</a>--> <!--바로 보이게 수정하기-->
							</div>
						</div>
						<div class="review_column">
							<div class="review_image">
								<img src="{{ review.photo.url }}" alt=""/>
							</div>
						</div>​
					</div>
					{% else %}
					<div class="review_text">
						{{ review.content }}
					</div>	
					{% endif %}
				
				<div  class="button-wrapper">
						<span>
							<i class="material-icons">portrait</i> <!--icon needed to change-->
							{{ review.author.username }}
						</span>
					<a  href="/reviews/{{ review.id }}/like"> 
						{% if  user in review.liked_users.all %}
						<img class="like" src="https://image.flaticon.com/icons/svg/25/25423.svg">
						{% else %}
						<img class="like" src="https://image.flaticon.com/icons/svg/25/25297.svg">
						{% endif %}
						{{ review.liked_users.count }}
					</a>

					{% if request.user == review.author %}
						<a  href="/reviews/{{ review.id }}/edit">
						<i  class="material-icons">edit</i>
						</a>
						<a  href="/reviews/{{ review.id }}/delete"  onclick="return confirm('정말 삭제하시겠습니까?')">
						<i  class="material-icons">delete</i>
						</a>
					{% endif %}
				</div>
			</div>
		</div>
	</div>
  {% endfor %}
{% endblock content %}